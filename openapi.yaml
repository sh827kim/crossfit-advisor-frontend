openapi: 3.0.0
info:
  title: After WOD API
  description: CrossFit 보조 운동 계획 생성 및 운동 기록 관리 API
  version: 1.0.0
  contact:
    name: Hound ANAS
  license:
    name: MIT

servers:
  - url: http://localhost:8080
    description: 개발 서버

tags:
  - name: 인증
    description: 사용자 인증 관련 API
  - name: 사용자
    description: 사용자 정보 조회 및 관리
  - name: 운동 계획
    description: 운동 계획 생성 및 조회
  - name: 운동 기록
    description: 운동 기록 저장 및 조회

paths:
  /oauth2/authorization/google:
    get:
      tags:
        - 인증
      summary: Google OAuth 인증 시작
      description: Google을 통한 OAuth 인증을 시작합니다. Google 로그인 후 자동으로 리다이렉트되며 refreshToken이 쿼리 파라미터로 전달됩니다.
      parameters:
        - name: redirect_uri
          in: query
          description: Google 인증 후 리다이렉트될 클라이언트 URI (선택사항)
          schema:
            type: string
            format: uri
      responses:
        '302':
          description: Google 로그인 페이지로 리다이렉트
        '200':
          description: Google 인증 성공 후 클라이언트로 리다이렉트 (refreshToken 포함)
          content:
            text/html:
              example: 'HTTP/302 Location: {redirect_uri}?refreshToken={refreshToken}'

  /auth/logout:
    post:
      tags:
        - 인증
      summary: 로그아웃
      description: 사용자 로그아웃
      security:
        - BearerAuth: []
      responses:
        '200':
          description: 로그아웃 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /auth-token/refresh:
    post:
      tags:
        - 인증
      summary: 토큰 갱신
      description: 리프레시 토큰을 이용하여 새로운 액세스 토큰 및 리프레시 토큰 발급
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  description: 리프레시 토큰
      responses:
        '200':
          description: 토큰 갱신 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenRefreshResponse'
        '401':
          description: 토큰 갱신 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/users/profile:
    get:
      tags:
        - 사용자
      summary: 사용자 프로필 조회
      description: 현재 로그인한 사용자의 프로필 정보 조회
      security:
        - BearerAuth: []
      responses:
        '200':
          description: 프로필 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/users/stats:
    get:
      tags:
        - 사용자
      summary: 사용자 통계 조회
      description: 사용자의 운동 통계 정보 조회
      security:
        - BearerAuth: []
      parameters:
        - name: period
          in: query
          description: 통계 기간 (month, quarter, year)
          schema:
            type: string
            default: month
            enum:
              - month
              - quarter
              - year
      responses:
        '200':
          description: 통계 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserStatsResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/movements:
    get:
      tags:
        - 운동 계획
      summary: 운동 목록 조회
      description: 전체 CrossFit 운동 목록 조회 (검색 지원)
      parameters:
        - name: keyword
          in: query
          description: 검색 키워드 (한글 또는 초성)
          schema:
            type: string
          example: 스내치
      responses:
        '200':
          description: 운동 목록 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MovementListResponse'

  /api/v1/movements/goals:
    get:
      tags:
        - 운동 계획
      summary: 달성 목표 운동 목록 조회
      description: 스킬 달성 목표 운동 목록 조회
      responses:
        '200':
          description: 달성 목표 운동 목록 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MovementListResponse'

  /api/v1/workouts/generate/wod:
    post:
      tags:
        - 운동 계획
      summary: 운동 계획 생성 - WOD 모드 (부족한 부위 채우기)
      description: |
        오늘 수행한 WOD를 기반으로 부족한 부위를 채울 운동 계획을 생성합니다.
        생성된 계획은 데이터베이스에 저장되지 않으며, 사용자가 운동을 시작할 때 저장됩니다.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkoutGenerateWodRequest'
            example:
              duration: 20
              wodMovementIds: [mov1, mov5, mov10]
      responses:
        '200':
          description: 운동 계획 생성 성공 (임시 데이터)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutGenerateResponse'
        '400':
          description: 요청 데이터 유효성 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorBadRequestResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/workouts/generate/goal:
    post:
      tags:
        - 운동 계획
      summary: 운동 계획 생성 - GOAL 모드 (나의 달성 목표)
      description: |
        달성하고 싶은 스킬을 기반으로 목표 달성을 위한 운동 계획을 생성합니다.
        사용자의 난이도에 맞는 템플릿을 사용하여 계획을 생성합니다.
        생성된 계획은 데이터베이스에 저장되지 않으며, 사용자가 운동을 시작할 때 저장됩니다.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkoutGenerateGoalRequest'
            example:
              duration: 20
              goalMovementId: muscle_up
              difficultyLevel: BEGINNER
      responses:
        '200':
          description: 운동 계획 생성 성공 (임시 데이터)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutGenerateResponse'
        '400':
          description: 요청 데이터 유효성 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorBadRequestResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/workouts/generate/part:
    post:
      tags:
        - 운동 계획
      summary: 운동 계획 생성 - PART 모드 (타겟 부위 선택)
      description: |
        선택한 부위를 집중적으로 운동할 계획을 생성합니다.
        생성된 계획은 데이터베이스에 저장되지 않으며, 사용자가 운동을 시작할 때 저장됩니다.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkoutGeneratePartRequest'
            example:
              duration: 20
              targetMuscleGroups: [CORE, CHEST]
      responses:
        '200':
          description: 운동 계획 생성 성공 (임시 데이터)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutGenerateResponse'
        '400':
          description: 요청 데이터 유효성 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorBadRequestResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/workouts/records:
    get:
      tags:
        - 운동 기록
      summary: 운동 기록 조회
      description: |
        사용자의 운동 기록 조회
        - date 파라미터: 특정 날짜의 기록 조회
        - year, month 파라미터: 특정 월의 기록 및 캘린더 데이터 조회
        - startDate, endDate: 날짜 범위로 기록 조회
      security:
        - BearerAuth: []
      parameters:
        - name: date
          in: query
          description: 조회할 특정 날짜 (YYYY-MM-DD) - 이 파라미터 사용 시 해당 날짜 기록 반환
          schema:
            type: string
            format: date
        - name: year
          in: query
          description: 조회할 연도 (year, month 함께 사용 시 월별 캘린더 데이터 반환)
          schema:
            type: integer
            example: 2026
        - name: month
          in: query
          description: 조회할 월 (1-12, year와 함께 사용)
          schema:
            type: integer
            example: 1
        - name: startDate
          in: query
          description: 시작 날짜 (YYYY-MM-DD) - 범위 조회 시 사용
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          description: 종료 날짜 (YYYY-MM-DD) - 범위 조회 시 사용
          schema:
            type: string
            format: date
        - name: limit
          in: query
          description: 조회 결과 개수 제한
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: 운동 기록 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutHistoryResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'
    post:
      tags:
        - 운동 기록
      summary: 운동 기록 시작
      description: 생성된 운동 계획을 기반으로 운동을 시작하며 기록을 생성합니다.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StartWorkoutRecordRequest'
      responses:
        '201':
          description: '운동 기록 생성 성공 (status: STARTED)'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutRecordResponse'
        '400':
          description: 요청 데이터 유효성 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorBadRequestResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

  /api/v1/workouts/records/{recordId}/exercises/complete:
    patch:
      tags:
        - 운동 기록
      summary: 운동 세트 완료
      description: 운동 기록의 특정 세트를 완료 처리합니다. 여러 세트를 동시에 완료할 수 있습니다.
      security:
        - BearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: 운동 기록 ID
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompleteExercisesRequest'
      responses:
        '200':
          description: 운동 세트 완료 처리 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutRecordResponse'
        '400':
          description: 요청 데이터 유효성 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorBadRequestResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'
        '404':
          description: 운동 기록을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorNotFoundResponse'

  /api/v1/workouts/records/{recordId}:
    get:
      tags:
        - 운동 기록
      summary: 운동 기록 단건 조회
      description: 특정 운동 기록을 상세 조회합니다. 화면 리프레시 등으로 현재 진행 중인 운동 정보를 다시 불러올 때 사용합니다.
      security:
        - BearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: 운동 기록 ID
          schema:
            type: string
      responses:
        '200':
          description: 운동 기록 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkoutRecordResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'
        '404':
          description: 운동 기록을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorNotFoundResponse'
    delete:
      tags:
        - 운동 기록
      summary: 운동 기록 삭제
      description: 저장된 운동 기록 삭제
      security:
        - BearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: 운동 기록 ID
          schema:
            type: string
      responses:
        '200':
          description: 운동 기록 삭제 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmptyResponse'
        '404':
          description: 운동 기록을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorNotFoundResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorizedResponse'

components:
  schemas:
    CommonResult:
      type: object
      description: 모든 API 응답의 공통 포맷
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          description: 요청 성공 여부
        message:
          type: string
          description: 응답 메시지
        data:
          type: object
          description: 실제 응답 데이터 (실패 시 에러 정보, 성공 시 비즈니스 데이터)
          nullable: true

    # 응답 스키마들
    EmptyResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
      example:
        success: true
        message: 요청이 성공했습니다.
        data: null

    ErrorUnauthorizedResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
      example:
        success: false
        message: 인증 실패
        data: null

    ErrorBadRequestResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
      example:
        success: false
        message: 요청 데이터가 유효하지 않습니다.
        data: null

    ErrorNotFoundResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
      example:
        success: false
        message: 요청한 리소스를 찾을 수 없습니다.
        data: null

    TokenRefreshResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/TokenPair'
      example:
        success: true
        message: 토큰 갱신 성공
        data:
          accessToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
          accessTokenExpiresInSec: 3600
          refreshToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
          refreshTokenExpiresInSec: 604800

    UserProfileResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/UserProfile'
      example:
        success: true
        message: 프로필 조회 성공
        data:
          id: user123
          name: 김크로스핏
          email: crossfitter@gmail.com
          googleId: google123
          profileImage: https://example.com/profile.jpg
          createdAt: '2026-01-01T00:00:00'
          exerciseCountThisMonth: 12

    UserStatsResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/UserStats'
      example:
        success: true
        message: 통계 조회 성공
        data:
          totalCount: 24
          averageTime: 18.5
          mostUsedMode: wod
          favoriteExercises: [스내치, 풀업, 플랭크]

    MovementListResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/MovementList'
      example:
        success: true
        message: 운동 목록 조회 성공
        data:
          movements:
            - id: mov1
              name: 할로우 락
              muscleGroups: [CORE]
              equipment: [BODYWEIGHT]
            - id: mov2
              name: 스내치
              muscleGroups: [LEGS, BACK, SHOULDER]
              equipment: [BARBELL]
          total: 2


    WorkoutGenerateResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/WorkoutPlan'
      example:
        success: true
        message: 운동 계획이 생성되었습니다.
        data:
          mode: WOD
          duration: 20
          rounds: 6
          targetTimePerRound: 3분 20초
          exercises:
            - exerciseId: 0
              movementId: mov1
              name: 할로우 락
              minReps: 10
              maxReps: 15
              equipment:
                - BODYWEIGHT
              muscleGroups:
                - CORE
            - exerciseId: 1
              movementId: mov2
              name: 플랭크
              minReps: 30
              maxReps: 60
              equipment:
                - BODYWEIGHT
              muscleGroups:
                - CORE
          modeDisplay: 부족 부위 채우기

    WorkoutHistoryResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/WorkoutHistory'
      example:
        success: true
        message: 운동 기록 조회 성공
        data:
          year: 2026
          month: 1
          records:
            - id: rec1
              userId: user123
              date: '2026-01-15'
              mode: WOD
              duration: 20
              status: STARTED
              exercises:
                - exerciseId: 0
                  movementId: mov1
                  movementName: 할로우 락
                  status: STARTED
                  completedAt: null
                - exerciseId: 1
                  movementId: mov2
                  movementName: 플랭크
                  status: STARTED
                  completedAt: null
              modeDisplay: 부족 부위 채우기
              startedAt: '2026-01-15 10:30:00'
          calendarData:
            - date: '2026-01-15'
              hasRecord: true

    # 데이터 스키마들
    TokenPair:
      type: object
      description: 액세스 토큰과 리프레시 토큰 쌍
      required:
        - accessToken
        - accessTokenExpiresInSec
        - refreshToken
        - refreshTokenExpiresInSec
      properties:
        accessToken:
          type: string
          description: JWT 액세스 토큰
        accessTokenExpiresInSec:
          type: integer
          format: int64
          description: 액세스 토큰 만료 시간 (초 단위)
        refreshToken:
          type: string
          description: JWT 리프레시 토큰
        refreshTokenExpiresInSec:
          type: integer
          format: int64
          description: 리프레시 토큰 만료 시간 (초 단위)

    UserProfile:
      type: object
      description: 사용자 프로필 정보
      required:
        - id
        - name
        - email
      properties:
        id:
          type: string
          description: 사용자 ID
        name:
          type: string
          description: 사용자 이름
        email:
          type: string
          description: 이메일 주소
        googleId:
          type: string
          description: Google 계정 ID
        profileImage:
          type: string
          format: uri
          description: 프로필 이미지 URL
        createdAt:
          type: string
          format: date-time
          description: 계정 생성 시간
        exerciseCountThisMonth:
          type: integer
          description: 이번 달 운동 횟수

    UserStats:
      type: object
      description: 사용자 운동 통계
      required:
        - totalCount
        - averageTime
      properties:
        totalCount:
          type: integer
          description: 총 운동 횟수
        averageTime:
          type: number
          format: double
          description: 평균 운동 시간 (분)
        mostUsedMode:
          type: string
          enum:
            - WOD
            - GOAL
            - PART
          description: 가장 많이 사용한 모드
        favoriteExercises:
          type: array
          items:
            type: string
          description: 즐겨 하는 운동 목록

    User:
      type: object
      properties:
        id:
          type: string
          description: 사용자 ID
        name:
          type: string
          description: 사용자 이름
        email:
          type: string
          description: 이메일 주소
        googleId:
          type: string
          description: Google 계정 ID
        profileImage:
          type: string
          format: uri
          description: 프로필 이미지 URL
        createdAt:
          type: string
          format: date-time
          description: 계정 생성 시간
        updatedAt:
          type: string
          format: date-time
          description: 계정 수정 시간

    Movement:
      type: object
      properties:
        id:
          type: string
          description: 운동 ID
        name:
          type: string
          description: 운동 이름
        muscleGroups:
          type: array
          description: 타겟 근육 그룹
          items:
            type: string
            enum:
              - CORE
              - LEGS
              - BACK
              - CHEST
              - SHOULDER
              - ARMS
              - CARDIO
              - FULL
        equipment:
          type: array
          description: 필요한 장비
          items:
            type: string
            enum:
              - BODYWEIGHT
              - GHD
              - BAR
              - BAND
              - RINGS
              - BARBELL
              - BOX
              - DUMBBELL
              - KETTLEBELL
              - WALLBALL
              - WALL
              - ASSAULT_BIKE
              - ROWING

    MovementList:
      type: object
      description: 운동 목록 조회 결과 (일반 운동 목록, 자주 나오는 운동, 달성 목표 운동 등에서 모두 사용)
      required:
        - movements
        - total
      properties:
        movements:
          type: array
          items:
            $ref: '#/components/schemas/Movement'
          description: 운동 목록 (Movement 객체 배열)
        total:
          type: integer
          description: 전체 운동 개수

    WorkoutGenerateWodRequest:
      type: object
      required:
        - duration
      properties:
        duration:
          type: integer
          description: 운동 시간 (분)
          enum:
            - 1
            - 5
            - 10
            - 15
            - 20
            - 25
            - 30
        wodMovementIds:
          type: array
          items:
            type: string
          description: 오늘 수행한 운동 ID 목록

    WorkoutGenerateGoalRequest:
      type: object
      required:
        - duration
        - goalMovementId
        - difficultyLevel
      properties:
        duration:
          type: integer
          description: 운동 시간 (분)
          enum:
            - 1
            - 5
            - 10
            - 15
            - 20
            - 25
            - 30
        goalMovementId:
          type: string
          description: 달성하고 싶은 스킬의 운동 ID
        difficultyLevel:
          type: string
          description: 난이도 (초보자/중급자/상급자)
          enum:
            - BEGINNER
            - INTERMEDIATE
            - ADVANCED

    WorkoutGeneratePartRequest:
      type: object
      required:
        - duration
        - targetMuscleGroups
      properties:
        duration:
          type: integer
          description: 운동 시간 (분)
          enum:
            - 1
            - 5
            - 10
            - 15
            - 20
            - 25
            - 30
        targetMuscleGroups:
          type: array
          description: 타겟 근육 그룹
          items:
            type: string
            enum:
              - CORE
              - LEGS
              - BACK
              - CHEST
              - SHOULDER
              - ARMS
              - CARDIO
              - FULL

    StartWorkoutRecordRequest:
      type: object
      required:
        - mode
        - duration
        - exercises
      properties:
        mode:
          type: string
          description: 운동 계획 모드
          enum:
            - WOD
            - GOAL
            - PART
        duration:
          type: integer
          description: 운동 시간 (분)
          enum:
            - 1
            - 5
            - 10
            - 15
            - 20
            - 25
            - 30
        exercises:
          type: array
          items:
            $ref: '#/components/schemas/ExerciseInput'
          description: 운동 목록

    ExerciseInput:
      type: object
      required:
        - exerciseId
        - movementId
      properties:
        exerciseId:
          type: integer
          description: 계획 내 운동 순서 (0부터 시작)
        movementId:
          type: string
          description: 운동 ID (movements 테이블 참조)
        minReps:
          type: integer
          description: 최소 반복 횟수
        maxReps:
          type: integer
          description: 최대 반복 횟수
        equipment:
          type: array
          items:
            type: string
          description: 필요 장비

    CompleteExercisesRequest:
      type: object
      required:
        - exerciseIds
      properties:
        exerciseIds:
          type: array
          items:
            type: integer
          description: 완료할 운동의 exerciseId 배열

    WorkoutPlan:
      type: object
      description: 생성된 운동 계획 (임시 데이터, DB에 저장되지 않음)
      required:
        - mode
        - duration
        - rounds
        - exercises
      properties:
        mode:
          type: string
          description: 운동 모드
          enum:
            - WOD
            - GOAL
            - PART
        duration:
          type: integer
          description: 운동 시간 (분)
        rounds:
          type: integer
          description: 라운드 수
        targetTimePerRound:
          type: string
          description: 라운드당 목표 시간
        exercises:
          type: array
          items:
            $ref: '#/components/schemas/Exercise'
          description: 운동 목록
        modeDisplay:
          type: string
          description: 모드 표시 텍스트

    Exercise:
      type: object
      required:
        - exerciseId
        - movementId
        - name
      properties:
        exerciseId:
          type: integer
          description: 이 계획 내에서의 운동 순서 (0부터 시작)
        movementId:
          type: string
          description: 운동 ID (movements 테이블 참조)
        name:
          type: string
          description: 운동 이름
        minReps:
          type: integer
          description: 최소 반복 횟수
        maxReps:
          type: integer
          description: 최대 반복 횟수
        equipment:
          type: array
          description: 필요 장비
          items:
            type: string
            enum:
              - BODYWEIGHT
              - GHD
              - BAR
              - BAND
              - RINGS
              - BARBELL
              - BOX
              - DUMBBELL
              - KETTLEBELL
              - WALLBALL
              - WALL
              - ASSAULT_BIKE
              - ROWING
        muscleGroups:
          type: array
          description: 타겟 근육 그룹
          items:
            type: string
            enum:
              - CORE
              - LEGS
              - BACK
              - CHEST
              - SHOULDER
              - ARMS
              - CARDIO
              - FULL

    WorkoutHistory:
      type: object
      description: 운동 기록 조회 결과
      required:
        - records
      properties:
        year:
          type: integer
          description: 조회한 연도
        month:
          type: integer
          description: 조회한 월
        records:
          type: array
          items:
            $ref: '#/components/schemas/WorkoutRecord'
          description: 운동 기록 목록
        calendarData:
          type: array
          items:
            $ref: '#/components/schemas/CalendarDay'
          description: 월별 캘린더 데이터

    CalendarDay:
      type: object
      description: 캘린더 날짜 정보
      required:
        - date
        - hasRecord
      properties:
        date:
          type: string
          format: date
        hasRecord:
          type: boolean
          description: 해당 날짜에 운동 기록이 있는지 여부

    WorkoutRecord:
      type: object
      description: 운동 기록
      required:
        - id
        - userId
        - date
        - mode
        - duration
        - status
        - exercises
      properties:
        id:
          type: string
          description: 기록 ID
        userId:
          type: string
          description: 사용자 ID
        date:
          type: string
          format: date
          description: 운동 날짜
        mode:
          type: string
          description: 운동 계획 모드
          enum:
            - WOD
            - GOAL
            - PART
        duration:
          type: integer
          description: 운동 시간 (분)
        status:
          type: string
          description: '운동 상태 (STARTED: 진행 중, COMPLETED: 완료)'
          enum:
            - STARTED
            - COMPLETED
        exercises:
          type: array
          items:
            $ref: '#/components/schemas/RecordExercise'
          description: 운동 목록
        modeDisplay:
          type: string
          description: 모드 표시 텍스트
        notes:
          type: string
          description: 메모
        startedAt:
          type: string
          format: date-time
          description: 운동 시작 시간
        completedAt:
          type: string
          format: date-time
          description: 운동 완료 시간
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    RecordExercise:
      type: object
      description: 운동 기록의 세트 정보
      required:
        - exerciseId
        - movementId
        - movementName
        - status
      properties:
        exerciseId:
          type: integer
          description: 계획 내 운동 순서 (0부터 시작)
        movementId:
          type: string
          description: 운동 ID (movements 테이블 참조)
        movementName:
          type: string
          description: 운동 이름
        minReps:
          type: integer
          description: 최소 반복 횟수
        maxReps:
          type: integer
          description: 최대 반복 횟수
        status:
          type: string
          description: 세트 상태
          enum:
            - NOT_STARTED
            - STARTED
            - COMPLETED
        startedAt:
          type: string
          format: date-time
          description: 세트 시작 시간
          nullable: true
        completedAt:
          type: string
          format: date-time
          description: 세트 완료 시간
          nullable: true

    WorkoutRecordResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResult'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/WorkoutRecord'
      example:
        success: true
        message: 운동 기록이 생성되었습니다.
        data:
          id: rec123
          date: '2026-01-15'
          mode: WOD
          duration: 20
          status: STARTED
          exercises:
            - exerciseId: 0
              movementId: mov1
              movementName: 할로우 락
              minReps: 10
              maxReps: 15
              status: STARTED
              startedAt: '2026-01-15 10:30:00'
              completedAt: null
            - exerciseId: 1
              movementId: mov2
              movementName: 플랭크
              minReps: 30
              maxReps: 60
              status: NOT_STARTED
              startedAt: null
              completedAt: null
          modeDisplay: 부족 부위 채우기
          startedAt: '2026-01-15 10:30:00'
          completedAt: null
          createdAt: '2026-01-15 10:30:00'
          updatedAt: '2026-01-15 10:30:00'

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT 기반 인증 (로그인 후 발급받은 accessToken 사용)

security:
  - BearerAuth: []
